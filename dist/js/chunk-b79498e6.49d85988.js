(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b79498e6"],{"7db0":function(t,e,a){"use strict";var i=a("23e7"),n=a("b727").find,o=a("44d2"),s="find",r=!0;s in[]&&Array(1)[s]((function(){r=!1})),i({target:"Array",proto:!0,forced:r},{find:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),o(s)},c1c4:function(t,e,a){"use strict";a.r(e);var i=a("7a23"),n={class:"bg-primary navHeader py-6"},o={class:"container"},s={class:"d-flex justify-content-between align-items-center"},r=["src"],c=Object(i["g"])("i",{class:"bi bi-chevron-left d-block d-lg-none text-dark"},null,-1),d={class:"switchBike d-none d-lg-block",for:"switchbike"},l=Object(i["h"])('<div class="switchBike-text"><span class="d-flex align-items-center"><i class="fas fa-biking me-3"></i>租 車</span><span class="d-flex align-items-center"><i class="fas fa-parking me-3"></i>還 車</span></div>',1),h=Object(i["g"])("div",{class:"switchBike-control text-primary"},[Object(i["g"])("span",null,[Object(i["g"])("i",{class:"fas fa-biking me-3"}),Object(i["i"])("租 車")]),Object(i["g"])("span",null,[Object(i["g"])("i",{class:"fas fa-parking me-3"}),Object(i["i"])("還 車")])],-1),u={class:"switchRoad",for:"switchroad"},f=Object(i["g"])("div",{class:"switchRoad-text px-3"},[Object(i["g"])("span",null,"顯示車道"),Object(i["g"])("span",null,"隱藏車道")],-1),p={class:"position-relative"},g=Object(i["h"])('<div class="mt-3 w-25 d-none position-absolute start-50 top-10 translate-middle" style="z-index:1000;"><input type="text" class="form-control me-3" id="exampleFormControlInput1" placeholder="尋找站點"><a href="#" class="btn btn-dark"><i class="bi bi-search"></i></a></div><div id="map" class="map mapBike"></div>',2),b={class:"d-lg-none py-3 d-flex bg-primary position-absolute bottom-0 w-100",style:{"z-index":"1000"}},k={class:"w-50 text-center"},m=Object(i["g"])("i",{class:"fas fa-biking me-3"},null,-1),y=Object(i["i"])("租 車"),v=[m,y],w={class:"w-50 text-center"},O=Object(i["g"])("i",{class:"fas fa-parking me-3"},null,-1),B=Object(i["i"])("還 車"),j=[O,B];function R(t,e,m,y,O,B){var R=Object(i["x"])("router-link");return Object(i["s"])(),Object(i["f"])(i["a"],null,[Object(i["g"])("nav",n,[Object(i["g"])("div",o,[Object(i["g"])("div",s,[Object(i["j"])(R,{to:"/"},{default:Object(i["D"])((function(){return[Object(i["g"])("img",{class:"navHeader-logo d-none d-lg-block",src:a("4ffd"),alt:""},null,8,r),c]})),_:1}),Object(i["g"])("label",d,[l,Object(i["g"])("input",{type:"checkbox",id:"switchbike",onClick:e[0]||(e[0]=function(t){return B.switchRentReturn()})}),h]),Object(i["g"])("label",u,[Object(i["g"])("input",{type:"checkbox",id:"switchroad",onClick:e[1]||(e[1]=function(t){return B.swicthBikeRoad()})}),f])])])]),Object(i["g"])("div",p,[g,Object(i["g"])("footer",b,[Object(i["g"])("div",k,[Object(i["g"])("a",{href:"#",onClick:e[2]||(e[2]=Object(i["F"])((function(t){return B.switchRentReturn()}),["prevent"])),class:"footerBar-link text-decoration-none"},v)]),Object(i["g"])("div",w,[Object(i["g"])("a",{href:"#",onClick:e[3]||(e[3]=Object(i["F"])((function(t){return B.switchRentReturn()}),["prevent"])),class:"footerBar-link text-decoration-none"},j)])])])],64)}var C=a("5530"),S=(a("99af"),a("d3b7"),a("159b"),a("7db0"),a("d81d"),a("6c2d")),x=a("e11e"),A=a.n(x),T=a("1134"),P=a.n(T),L=(a("7319"),{}),N={},M=new P.a.Wkt,I=new A.a.MarkerClusterGroup,E=function(){var t="14f35d990f6c4fcfafe0dd94241c0716",e="BC9NwRZaQgqYSA2R2Y7wNiBP0TE",a=(new Date).toUTCString(),i=new S["a"]("SHA-1","TEXT");i.setHMACKey(e,"TEXT"),i.update("x-date: ".concat(a));var n=i.getHMAC("B64"),o='hmac username="'.concat(t,'", algorithm="hmac-sha1", headers="x-date", signature="').concat(n,'"');return{Authorization:o,"X-Date":a}},D={data:function(){return{local:{},data:[],road:[],myLayers:[],latitude:NaN,longitude:NaN,areaKey:"",swichBikeStation:!0,switchBikesRoad:!0,currentCategory:{TXG:"Taichung",KEE:"Keelung",HSQ:"HsinchuCounty",MIA:"MiaoliCounty",CHA:"ChanghuaCounty",NWT:"NewTaipei",NAN:"NantouCounty",YUN:"YunlinCounty",CYQ:"ChiayiCounty",CYI:"Chiayi",PIF:"PingtungCounty",ILA:"YilanCounty",HUA:"HualienCounty",TTT:"TaitungCounty",KIN:"KinmenCounty",PEN:"PenghuCounty",TAO:"Taoyuan",TPE:"Taipei",KHH:"Kaohsiung",TNN:"Tainan"}}},methods:{getBikeRentPosition:function(){var t=this,e="https://ptx.transportdata.tw/MOTC/v2/Bike/Station/NearBy?$top=30&$spatialFilter=nearby(".concat(this.latitude,",").concat(this.longitude,",800)");this.$http.get(e,{headers:E()}).then((function(e){var a=e.data;a.forEach((function(e){var a={BikesCapacity:e.BikesCapacity,StationAddress:e.StationAddress,StationPosition:e.StationPosition,StationID:e.StationID,AuthorityID:e.AuthorityID};t.data.push(a)})),t.getBikeRentInfo()}))},getBikeRentInfo:function(){var t=this,e="https://ptx.transportdata.tw/MOTC/v2/Bike/Availability/NearBy?$top=30&$spatialFilter=nearby(".concat(this.latitude,",").concat(this.longitude,",800)");this.$http.get(e,{headers:E()}).then((function(e){var a=e.data;a.forEach((function(e){var a=t.data.find((function(t){return t.StationID===e.StationID}));a&&(a.StationUID=e.StationUID,a.AvailableRentBikes=e.AvailableRentBikes,a.AvailableReturnBikes=e.AvailableReturnBikes,a.ServiceStatus=e.ServiceStatus)})),t.areaKey=t.currentCategory[t.data[0].AuthorityID],t.renderMarker(),t.getBikeRoad()}))},getBikeRoad:function(){var t=this,e="https://ptx.transportdata.tw/MOTC/v2/Cycling/Shape/".concat(this.areaKey,"?$format=JSON");this.$http.get(e,{headers:E()}).then((function(e){t.road=e.data,t.road.forEach((function(t){t.Geometry=M.read(t.Geometry).toJson()})),t.showBikeRoad()}))},changeMapCenter:function(t,e){L.panTo([t,e]),L.setZoom(16)},renderMap:function(){L=A.a.map("map",Object(C["a"])({},this.local));var t=new A.a.Icon({iconUrl:"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});A.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(L),A.a.marker(this.local.center,Object(C["a"])({},t)).addTo(L),this.getBikeRentPosition()},renderMarker:function(){this.data.forEach((function(t){var e=A.a.divIcon({html:'<div class="Rentstation map-marker">\n          '.concat(t.AvailableRentBikes,"</div>"),className:"opactiy"});I.addLayer(A.a.marker([t.StationPosition.PositionLat,t.StationPosition.PositionLon],{icon:e}))})),L.addLayer(I)},showRentMarker:function(){this.removeMarker(),this.data.forEach((function(t){var e=A.a.divIcon({html:'<div class="Rentstation map-marker">'.concat(t.AvailableRentBikes,"</div>"),className:"opactiy"});I.addLayer(A.a.marker([t.StationPosition.PositionLat,t.StationPosition.PositionLon],{icon:e}))})),L.addLayer(I)},showReturnMarker:function(){this.removeMarker(),this.data.forEach((function(t){var e=A.a.divIcon({html:'<div class="Returnstation map-marker">'.concat(t.AvailableReturnBikes,"</div>"),className:"opactiy"});I.addLayer(A.a.marker([t.StationPosition.PositionLat,t.StationPosition.PositionLon],{icon:e}))})),L.addLayer(I)},switchRentReturn:function(){this.swichBikeStation=!this.swichBikeStation,this.swichBikeStation?this.showRentMarker():this.showReturnMarker()},showBikeRoad:function(){var t=this,e={color:"red",weight:3,opacity:.5};this.road.forEach((function(a){N=A.a.geoJSON(a.Geometry,{style:e}).addTo(L),N.addData(a.Geometry),t.myLayers.push(N),L.fitBounds(N.getBounds()),t.changeMapCenter(t.latitude,t.longitude)}))},removeMarker:function(){I.eachLayer((function(t){I.removeLayer(t)}))},swicthBikeRoad:function(){this.switchBikesRoad=!this.switchBikesRoad,this.switchBikesRoad?this.showBikeRoad():this.removeBikeRoad()},removeBikeRoad:function(){this.myLayers.forEach((function(t){L.removeLayer(t)})),this.myLayers=[]},getLocation:function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(this.showPosition)},showPosition:function(t){this.latitude=t.coords.latitude,this.longitude=t.coords.longitude,this.local={center:[t.coords.latitude,t.coords.longitude],zoom:16},this.renderMap()}},mounted:function(){this.getLocation()}},H=a("6b0d"),K=a.n(H);const $=K()(D,[["render",R]]);e["default"]=$}}]);
//# sourceMappingURL=chunk-b79498e6.49d85988.js.map